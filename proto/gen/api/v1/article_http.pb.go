// Code generated by protoc-gen-go-http. DO NOT EDIT.
// versions:
// protoc-gen-go-http v0.0.1

package apiv1

import (
	context "context"
	contract "github.com/goapt/grpc-http/contract"
	httpbody "google.golang.org/genproto/googleapis/api/httpbody"
	emptypb "google.golang.org/protobuf/types/known/emptypb"
	http "net/http"
)

// This is a compile-time assertion to ensure that this generated file
// is compatible with the kratos package it is being compiled against.
// context.contract.http.

// ArticleService 提供文章相关的接口
type ArticleServiceHTTPServer interface {
	// Archive 获取文章归档
	Archive(context.Context, *emptypb.Empty) (*ArchiveResponse, error)
	// Calendar 获取日历文章日期
	Calendar(context.Context, *ArticleCalendarRequest) (*ArticleCalendarResponse, error)
	// Detail 获取文章详情
	Detail(context.Context, *ArticleDetailRequest) (*ArticleItem, error)
	// Feed 获取文章 RSS 订阅
	Feed(context.Context, *emptypb.Empty) (*httpbody.HttpBody, error)
	// List 获取文章列表
	List(context.Context, *ArticleListRequest) (*ArticleListResponse, error)
	// PrevNext 获取上一篇下一篇文章
	PrevNext(context.Context, *PrevNextRequest) (*PrevNextResponse, error)
}

type ArticleService struct {
	server ArticleServiceHTTPServer
	mux    contract.ServeMux
	codec  contract.Codec
}

func (s *ArticleService) RegisterService() {
	s.mux.HandleFunc("POST /blog/article/archive", s.Archive)
	s.mux.HandleFunc("POST /blog/article/list", s.List)
	s.mux.HandleFunc("POST /blog/article/prevnext", s.PrevNext)
	s.mux.HandleFunc("POST /blog/article/detail", s.Detail)
	s.mux.HandleFunc("GET /blog/feed.xml", s.Feed)
	s.mux.HandleFunc("POST /blog/article/calendar", s.Calendar)
}

func RegisterArticleServiceHTTPServer(mux contract.ServeMux, codec contract.Codec, srv ArticleServiceHTTPServer) {
	s := &ArticleService{
		server: srv,
		mux:    mux,
		codec:  codec,
	}
	s.RegisterService()
}

func (s *ArticleService) Archive(w http.ResponseWriter, r *http.Request) {
	var in emptypb.Empty

	out, err := s.server.Archive(r.Context(), &in)
	if err != nil {
		s.codec.Encode(w, r, err)
		return
	}
	s.codec.Encode(w, r, out)
	return
}

func (s *ArticleService) List(w http.ResponseWriter, r *http.Request) {
	var in ArticleListRequest
	if err := s.codec.Decode(r, &in); err != nil {
		s.codec.Encode(w, r, err)
		return
	}

	if err := s.codec.Validate(&in); err != nil {
		s.codec.Encode(w, r, err)
		return
	}

	out, err := s.server.List(r.Context(), &in)
	if err != nil {
		s.codec.Encode(w, r, err)
		return
	}
	s.codec.Encode(w, r, out)
	return
}

func (s *ArticleService) PrevNext(w http.ResponseWriter, r *http.Request) {
	var in PrevNextRequest
	if err := s.codec.Decode(r, &in); err != nil {
		s.codec.Encode(w, r, err)
		return
	}

	if err := s.codec.Validate(&in); err != nil {
		s.codec.Encode(w, r, err)
		return
	}

	out, err := s.server.PrevNext(r.Context(), &in)
	if err != nil {
		s.codec.Encode(w, r, err)
		return
	}
	s.codec.Encode(w, r, out)
	return
}

func (s *ArticleService) Detail(w http.ResponseWriter, r *http.Request) {
	var in ArticleDetailRequest
	if err := s.codec.Decode(r, &in); err != nil {
		s.codec.Encode(w, r, err)
		return
	}

	if err := s.codec.Validate(&in); err != nil {
		s.codec.Encode(w, r, err)
		return
	}

	out, err := s.server.Detail(r.Context(), &in)
	if err != nil {
		s.codec.Encode(w, r, err)
		return
	}
	s.codec.Encode(w, r, out)
	return
}

func (s *ArticleService) Feed(w http.ResponseWriter, r *http.Request) {
	var in emptypb.Empty

	out, err := s.server.Feed(r.Context(), &in)
	if err != nil {
		s.codec.Encode(w, r, err)
		return
	}
	w.Header().Set("Content-Type", out.ContentType)
	_, _ = w.Write(out.Data)
	return
}

func (s *ArticleService) Calendar(w http.ResponseWriter, r *http.Request) {
	var in ArticleCalendarRequest
	if err := s.codec.Decode(r, &in); err != nil {
		s.codec.Encode(w, r, err)
		return
	}

	if err := s.codec.Validate(&in); err != nil {
		s.codec.Encode(w, r, err)
		return
	}

	out, err := s.server.Calendar(r.Context(), &in)
	if err != nil {
		s.codec.Encode(w, r, err)
		return
	}
	s.codec.Encode(w, r, out)
	return
}
